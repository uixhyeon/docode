<template>
  <div class="code-archive-page">
    <!-- ìŠ¤í¬ë¡¤ ê¸°ë°˜ ê³ ì • ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="sticky-nav" :class="{ hidden: !showNav }">
      <div class="nav-content">
        <button
          v-for="section in sections"
          :key="section.id"
          @click="scrollToSection(section.id)"
          :class="{ active: activeSection === section.id }"
          class="nav-item"
        >
          {{ section.title }}
        </button>
      </div>
    </nav>

    <div class="page-content">
      <!-- í”„ë¡œì íŠ¸ ê°œìš” -->
      <section id="overview" class="content-section">
        <h1 class="main-title">ğŸ“¦ ì½”ë“œ ì•„ì¹´ì´ë¸Œ</h1>
        <p class="subtitle">ê°œë°œìë¥¼ ìœ„í•œ ì½”ë“œ ìŠ¤ë‹ˆí« ë° í•™ìŠµ ë…¸íŠ¸ ê´€ë¦¬ ì• í”Œë¦¬ì¼€ì´ì…˜</p>

        <div class="info-card">
          <h2>í”„ë¡œì íŠ¸ ì†Œê°œ</h2>
          <p>
            DoCodeëŠ” ê°œë°œ ì¤‘ ì‘ì„±í•œ ì½”ë“œì™€ í•™ìŠµ ë‚´ìš©ì„ ì²´ê³„ì ìœ¼ë¡œ ì •ë¦¬í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.
            í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì— í•„ìš”í•œ ë‹¤ì–‘í•œ ê¸°ìˆ ê³¼ íŒ¨í„´ì„ ì¹´í…Œê³ ë¦¬ë³„ë¡œ ì •ë¦¬í•˜ê³ ,
            ì½”ë“œ ìŠ¤ë‹ˆí«ì„ ì‘ì„±í•˜ì—¬ ì–¸ì œë“ ì§€ ì°¸ê³ í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.
          </p>
        </div>

        <div class="links-grid">
          <a href="https://code-archive-f7f9d.web.app" target="_blank" class="link-card">
            <div class="link-icon">ğŸŒ</div>
            <div class="link-title">ë¼ì´ë¸Œ ì‚¬ì´íŠ¸</div>
            <div class="link-url">code-archive-f7f9d.web.app</div>
          </a>
          <a href="https://github.com/uixhyeon/docode" target="_blank" class="link-card">
            <div class="link-icon">ğŸ’»</div>
            <div class="link-title">GitHub</div>
            <div class="link-url">github.com/uixhyeon/docode</div>
          </a>
        </div>
      </section>

      <!-- ê¸°ìˆ  ìŠ¤íƒ -->
      <section id="tech-stack" class="content-section">
        <h2>ğŸ›  ê¸°ìˆ  ìŠ¤íƒ</h2>

        <div class="tech-grid">
          <div class="tech-category">
            <h3>Frontend</h3>
            <ul>
              <li><strong>Vue 3</strong> - Composition API ì‚¬ìš©</li>
              <li><strong>Vue Router</strong> - SPA ë¼ìš°íŒ…</li>
              <li><strong>SCSS</strong> - ìŠ¤íƒ€ì¼ë§</li>
            </ul>
          </div>

          <div class="tech-category">
            <h3>Backend & Infrastructure</h3>
            <ul>
              <li><strong>Firebase Authentication</strong> - ì‚¬ìš©ì ì¸ì¦</li>
              <li><strong>Firestore</strong> - NoSQL ë°ì´í„°ë² ì´ìŠ¤</li>
              <li><strong>Firebase Hosting</strong> - ë°°í¬</li>
            </ul>
          </div>

          <div class="tech-category">
            <h3>Build Tools</h3>
            <ul>
              <li><strong>Vite</strong> - ë¹ ë¥¸ ê°œë°œ ì„œë²„ ë° ë¹Œë“œ</li>
              <li><strong>npm</strong> - íŒ¨í‚¤ì§€ ê´€ë¦¬</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- ì£¼ìš” ê¸°ëŠ¥ -->
      <section id="features" class="content-section">
        <h2>âœ¨ ì£¼ìš” ê¸°ëŠ¥</h2>

        <div class="features-grid">
          <div class="feature-card">
            <div class="feature-icon">ğŸ“</div>
            <h3>ì½”ë“œ ì‘ì„± ë° ê´€ë¦¬</h3>
            <p>ì£¼ì œë³„ë¡œ ì½”ë“œ ìŠ¤ë‹ˆí«ì„ ì‘ì„±í•˜ê³  ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¹´í…Œê³ ë¦¬ì™€ ì„œë¸Œì¹´í…Œê³ ë¦¬ë¡œ êµ¬ì¡°í™”ëœ ê´€ë¦¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
          </div>

          <div class="feature-card">
            <div class="feature-icon">ğŸ¨</div>
            <h3>Syntax Highlighting</h3>
            <p>JavaScript, TypeScript, Python, Vue, React ë“± ë‹¤ì–‘í•œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì˜ ë¬¸ë²• ê°•ì¡°ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.</p>
          </div>

          <div class="feature-card">
            <div class="feature-icon">ğŸ“„</div>
            <h3>ë°œì·Œ ê¸°ëŠ¥</h3>
            <p>ì›ë³¸ ë¬¸ì„œì—ì„œ í•„ìš”í•œ ë¶€ë¶„ë§Œ ë¼ì¸ ë‹¨ìœ„ë¡œ ì„ íƒí•˜ì—¬ ë°œì·Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë“œë˜ê·¸ë¡œ ì‰½ê²Œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
          </div>

          <div class="feature-card">
            <div class="feature-icon">ğŸ”—</div>
            <h3>ì„ë² ë“œ ì§€ì›</h3>
            <p>CodePen, CodeSandbox, Vercel ë“± ì™¸ë¶€ ì½”ë“œ ì‹¤í–‰ í™˜ê²½ì„ iframeìœ¼ë¡œ ì„ë² ë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
          </div>

          <div class="feature-card">
            <div class="feature-icon">ğŸ”</div>
            <h3>ì‚¬ìš©ì ì¸ì¦</h3>
            <p>Firebase Authenticationì„ í†µí•œ ì•ˆì „í•œ ë¡œê·¸ì¸ ì‹œìŠ¤í…œì„ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.</p>
          </div>

          <div class="feature-card">
            <div class="feature-icon">â˜ï¸</div>
            <h3>í´ë¼ìš°ë“œ ì €ì¥</h3>
            <p>Firestoreë¥¼ í†µí•´ ë°ì´í„°ë¥¼ í´ë¼ìš°ë“œì— ì €ì¥í•˜ê³  ì‹¤ì‹œê°„ìœ¼ë¡œ ë™ê¸°í™”í•©ë‹ˆë‹¤.</p>
          </div>
        </div>
      </section>

      <!-- í”„ë¡œì íŠ¸ êµ¬ì¡° -->
      <section id="structure" class="content-section">
        <h2>ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°</h2>

        <div class="code-block">
          <pre><code>docode/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/          # ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ Header.vue       # í—¤ë” (ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ, ë‹¤í¬ëª¨ë“œ)
â”‚   â”‚   â”œâ”€â”€ MDNSidebar.vue   # ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜
â”‚   â”‚   â””â”€â”€ TabNavigation.vue # íƒ­ ë„¤ë¹„ê²Œì´ì…˜
â”‚   â”œâ”€â”€ composables/         # Vue Composables
â”‚   â”‚   â””â”€â”€ useArticles.js   # Firestore ì•„í‹°í´ CRUD ë¡œì§
â”‚   â”œâ”€â”€ firebase/            # Firebase ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ config.js        # Firebase ì´ˆê¸°í™” ë° ì¸ì¦
â”‚   â”‚   â””â”€â”€ firestore.js     # Firestore CRUD í•¨ìˆ˜
â”‚   â”œâ”€â”€ router/              # Vue Router
â”‚   â”‚   â””â”€â”€ index.js         # ë¼ìš°íŒ… ì„¤ì • ë° ì¸ì¦ ê°€ë“œ
â”‚   â”œâ”€â”€ styles/              # ì „ì—­ ìŠ¤íƒ€ì¼
â”‚   â”‚   â”œâ”€â”€ main.scss        # ë©”ì¸ ìŠ¤íƒ€ì¼
â”‚   â”‚   â””â”€â”€ variables.scss   # SCSS ë³€ìˆ˜ (ìƒ‰ìƒ, í…Œë§ˆ)
â”‚   â”œâ”€â”€ views/               # í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ HomePage.vue     # ë©”ì¸ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ WritePage.vue    # ê¸€ì“°ê¸° í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ ArticlePage.vue  # ê¸€ ìƒì„¸ í˜ì´ì§€
â”‚   â”‚   â””â”€â”€ subjects/        # ì¹´í…Œê³ ë¦¬ë³„ í˜ì´ì§€
â”‚   â””â”€â”€ main.js              # Vue ì•± ì§„ì…ì 
â””â”€â”€ vite.config.js           # Vite ì„¤ì • (ê²½ë¡œ ë³„ì¹­ ë“±)</code></pre>
        </div>
      </section>

      <!-- í•µì‹¬ ì½”ë“œ ì„¤ëª… -->
      <section id="code" class="content-section">
        <h2>ğŸ’» í•µì‹¬ ì½”ë“œ ì„¤ëª…</h2>

        <div class="code-explanation">
          <h3>1. Firebase ì„¤ì • (config.js)</h3>
          <p>Firebase í”„ë¡œì íŠ¸ ì´ˆê¸°í™” ë° ì¸ì¦ ì„¤ì •ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.</p>
          <div class="code-block">
            <pre><code>import { initializeApp } from 'firebase/app'
import { getAuth } from 'firebase/auth'
import { getFirestore } from 'firebase/firestore'

const firebaseConfig = {
  apiKey: "...",
  authDomain: "code-archive-f7f9d.firebaseapp.com",
  projectId: "code-archive-f7f9d",
  // ...
}

const app = initializeApp(firebaseConfig)
export const auth = getAuth(app)
export const db = getFirestore(app)</code></pre>
          </div>
          <ul class="explanation-list">
            <li><code>initializeApp()</code>ìœ¼ë¡œ Firebase ì•± ì´ˆê¸°í™”</li>
            <li><code>getAuth()</code>ë¡œ ì¸ì¦ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±</li>
            <li><code>getFirestore()</code>ë¡œ Firestore ë°ì´í„°ë² ì´ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±</li>
          </ul>
        </div>

        <div class="code-explanation">
          <h3>2. Firestore CRUD (firestore.js)</h3>
          <p>Firestore ë°ì´í„°ë² ì´ìŠ¤ì˜ CRUD ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜ë“¤ì…ë‹ˆë‹¤.</p>
          <div class="code-block">
            <pre><code>// ê¸€ ì €ì¥
export const saveArticle = async (userId, articleData) => {
  const docRef = await addDoc(
    collection(db, 'users', userId, 'articles'),
    articleData
  )
  return docRef.id
}

// ê¸€ ëª©ë¡ ì¡°íšŒ
export const getArticles = async (userId, filters) => {
  let q = collection(db, 'users', userId, 'articles')

  if (filters.category) {
    q = query(q, where('category', '==', filters.category))
  }

  const snapshot = await getDocs(q)
  return snapshot.docs.map(doc => ({
    id: doc.id,
    ...doc.data()
  }))
}</code></pre>
          </div>
          <ul class="explanation-list">
            <li><code>addDoc()</code>ìœ¼ë¡œ ìƒˆ ë¬¸ì„œ ì¶”ê°€</li>
            <li><code>query()</code>ì™€ <code>where()</code>ë¡œ í•„í„°ë§ëœ ì¿¼ë¦¬ ìƒì„±</li>
            <li>ì‚¬ìš©ìë³„ë¡œ ë…ë¦½ëœ ì»¬ë ‰ì…˜ êµ¬ì¡° (<code>users/{userId}/articles</code>)</li>
          </ul>
        </div>

        <div class="code-explanation">
          <h3>3. Vue Composable (useArticles.js)</h3>
          <p>ê¸€ ëª©ë¡ì„ ê´€ë¦¬í•˜ëŠ” ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ë¡œì§ì…ë‹ˆë‹¤.</p>
          <div class="code-block">
            <pre><code>export const useArticles = (category, subcategory, page) => {
  const articles = ref([])
  const auth = getAuth()

  const loadArticles = async () => {
    const user = auth.currentUser
    if (!user) return

    const filters = { category, subcategory, page }
    articles.value = await getArticles(user.uid, filters)
  }

  const getArticles = (topicId) => {
    return articles.value.filter(
      article => article.topicId === topicId
    )
  }

  loadArticles()

  return { articles, getArticles }
}</code></pre>
          </div>
          <ul class="explanation-list">
            <li>Vue Composition APIì˜ <code>ref()</code>ë¡œ ë°˜ì‘í˜• ìƒíƒœ ê´€ë¦¬</li>
            <li>ì¹´í…Œê³ ë¦¬ë³„ë¡œ í•„í„°ë§ëœ ê¸€ ëª©ë¡ ì œê³µ</li>
            <li>ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ë¡œì§ ì¶”ìƒí™”</li>
          </ul>
        </div>

        <div class="code-explanation">
          <h3>4. ë¼ìš°í„° ì¸ì¦ ê°€ë“œ (router/index.js)</h3>
          <p>í˜ì´ì§€ ì ‘ê·¼ ì „ ì‚¬ìš©ì ì¸ì¦ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.</p>
          <div class="code-block">
            <pre><code>router.beforeEach(async (to, from, next) => {
  // Auth ìƒíƒœ ì´ˆê¸°í™” ëŒ€ê¸°
  if (!authReady) {
    await new Promise(resolve => {
      const unsubscribe = auth.onAuthStateChanged(() => {
        unsubscribe()
        resolve()
      })
    })
  }

  const user = auth.currentUser

  // ë¡œê·¸ì¸ í˜ì´ì§€ê°€ ì•„ë‹ˆë©´ ëª¨ë‘ ì¸ì¦ í•„ìš”
  if (to.path !== '/login' && to.path !== '/signup' && !user) {
    next('/login')
  } else {
    next()
  }
})</code></pre>
          </div>
          <ul class="explanation-list">
            <li><code>beforeEach()</code>ë¡œ ëª¨ë“  ë¼ìš°íŠ¸ ë³€ê²½ ì „ ê°€ë“œ ì‹¤í–‰</li>
            <li><code>onAuthStateChanged()</code>ë¡œ ì¸ì¦ ìƒíƒœ ì´ˆê¸°í™” ëŒ€ê¸°</li>
            <li>ë¯¸ì¸ì¦ ì‚¬ìš©ìëŠ” ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸</li>
          </ul>
        </div>
      </section>

      <!-- ê°œë°œ ê³¼ì • -->
      <section id="process" class="content-section">
        <h2>ğŸš€ ê°œë°œ ê³¼ì •</h2>

        <div class="timeline">
          <div class="timeline-item">
            <div class="timeline-marker">1</div>
            <div class="timeline-content">
              <h3>í”„ë¡œì íŠ¸ ì´ˆê¸° ì„¤ì •</h3>
              <ul>
                <li>Vite + Vue 3 í”„ë¡œì íŠ¸ ìƒì„±</li>
                <li>Firebase í”„ë¡œì íŠ¸ ìƒì„± ë° ì„¤ì •</li>
                <li>ê¸°ë³¸ ë¼ìš°íŒ… ë° ë ˆì´ì•„ì›ƒ êµ¬ì„±</li>
              </ul>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-marker">2</div>
            <div class="timeline-content">
              <h3>ì¸ì¦ ì‹œìŠ¤í…œ êµ¬í˜„</h3>
              <ul>
                <li>Firebase Authentication ì—°ë™</li>
                <li>ë¡œê·¸ì¸/íšŒì›ê°€ì… í˜ì´ì§€ êµ¬í˜„</li>
                <li>ë¼ìš°í„° ê°€ë“œë¡œ ì¸ì¦ ì²´í¬</li>
              </ul>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-marker">3</div>
            <div class="timeline-content">
              <h3>ì¹´í…Œê³ ë¦¬ êµ¬ì¡° ì„¤ê³„</h3>
              <ul>
                <li>ëŒ€ë¶„ë¥˜(ê³¼ëª©, UI, ê¸°ëŠ¥ê°œë°œ, ê¸°íƒ€) êµ¬ì„±</li>
                <li>ì¤‘ë¶„ë¥˜(React, Vue, JavaScript ë“±) í˜ì´ì§€ ìƒì„±</li>
                <li>ì†Œë¶„ë¥˜(Hooks, State ë“±) íƒ­ ë„¤ë¹„ê²Œì´ì…˜ êµ¬í˜„</li>
              </ul>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-marker">4</div>
            <div class="timeline-content">
              <h3>ê¸€ì“°ê¸° ê¸°ëŠ¥ êµ¬í˜„</h3>
              <ul>
                <li>ì–‘ìª½ íŒ¨ë„ ë ˆì´ì•„ì›ƒ (ì›ë³¸ ë¬¸ì„œ / ë…¸íŠ¸)</li>
                <li>ë¼ì¸ ë‹¨ìœ„ ë°œì·Œ ê¸°ëŠ¥</li>
                <li>Firestore ì €ì¥ ë¡œì§</li>
              </ul>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-marker">5</div>
            <div class="timeline-content">
              <h3>ì£¼ìš” ê¸°ëŠ¥ ì¶”ê°€</h3>
              <ul>
                <li>Syntax Highlighting ì ìš©</li>
                <li>ì„ë² ë“œ URL ì§€ì›</li>
                <li>ë‹¤í¬ëª¨ë“œ êµ¬í˜„</li>
                <li>ë°˜ì‘í˜• ë””ìì¸</li>
              </ul>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-marker">6</div>
            <div class="timeline-content">
              <h3>ë°°í¬ ë° ìµœì í™”</h3>
              <ul>
                <li>Firebase Hostingìœ¼ë¡œ ë°°í¬</li>
                <li>ë¹Œë“œ ìµœì í™”</li>
                <li>ì„±ëŠ¥ ê°œì„ </li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- í–¥í›„ ê³„íš -->
      <section id="future" class="content-section">
        <h2>ğŸ”® í–¥í›„ ê³„íš</h2>

        <div class="future-grid">
          <div class="future-card">
            <div class="future-icon">ğŸ”</div>
            <h3>ê²€ìƒ‰ ê¸°ëŠ¥</h3>
            <p>ì‘ì„±í•œ ê¸€ì„ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•˜ê³  í•„í„°ë§í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥</p>
          </div>

          <div class="future-card">
            <div class="future-icon">ğŸ·ï¸</div>
            <h3>íƒœê·¸ ì‹œìŠ¤í…œ</h3>
            <p>ê¸€ì— íƒœê·¸ë¥¼ ì¶”ê°€í•˜ì—¬ ë” ì„¸ë°€í•œ ë¶„ë¥˜ ë° ê²€ìƒ‰ ì§€ì›</p>
          </div>

          <div class="future-card">
            <div class="future-icon">ğŸ“Š</div>
            <h3>í†µê³„ ëŒ€ì‹œë³´ë“œ</h3>
            <p>í•™ìŠµ ì§„í–‰ë¥ ê³¼ ì‘ì„±í•œ ê¸€ì˜ í†µê³„ë¥¼ ì‹œê°í™”</p>
          </div>

          <div class="future-card">
            <div class="future-icon">ğŸ¤</div>
            <h3>ê³µìœ  ê¸°ëŠ¥</h3>
            <p>ì‘ì„±í•œ ì½”ë“œë¥¼ ë‹¤ë¥¸ ì‚¬ìš©ìì™€ ê³µìœ í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥</p>
          </div>
        </div>
      </section>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted, onUnmounted } from 'vue'

const sections = [
  { id: 'overview', title: 'ê°œìš”' },
  { id: 'tech-stack', title: 'ê¸°ìˆ  ìŠ¤íƒ' },
  { id: 'features', title: 'ì£¼ìš” ê¸°ëŠ¥' },
  { id: 'structure', title: 'í”„ë¡œì íŠ¸ êµ¬ì¡°' },
  { id: 'code', title: 'í•µì‹¬ ì½”ë“œ' },
  { id: 'process', title: 'ê°œë°œ ê³¼ì •' },
  { id: 'future', title: 'í–¥í›„ ê³„íš' }
]

const showNav = ref(true)
const activeSection = ref('overview')
let lastScrollY = 0
let ticking = false

// ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ì²˜ë¦¬
const handleScroll = () => {
  const currentScrollY = window.scrollY

  // ìŠ¤í¬ë¡¤ ë°©í–¥ì— ë”°ë¼ ë„¤ë¹„ê²Œì´ì…˜ í‘œì‹œ/ìˆ¨ê¹€
  if (currentScrollY > lastScrollY && currentScrollY > 100) {
    showNav.value = false // ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤
  } else {
    showNav.value = true // ìœ„ë¡œ ìŠ¤í¬ë¡¤
  }

  lastScrollY = currentScrollY

  // í˜„ì¬ ë³´ì´ëŠ” ì„¹ì…˜ í™•ì¸
  updateActiveSection()
}

// ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ìµœì í™” (requestAnimationFrame ì‚¬ìš©)
const onScroll = () => {
  if (!ticking) {
    window.requestAnimationFrame(() => {
      handleScroll()
      ticking = false
    })
    ticking = true
  }
}

// í˜„ì¬ í™œì„± ì„¹ì…˜ ì—…ë°ì´íŠ¸
const updateActiveSection = () => {
  const scrollPosition = window.scrollY + 150

  for (const section of sections) {
    const element = document.getElementById(section.id)
    if (element) {
      const { offsetTop, offsetHeight } = element
      if (scrollPosition >= offsetTop && scrollPosition < offsetTop + offsetHeight) {
        activeSection.value = section.id
        break
      }
    }
  }
}

// ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ì´ë™
const scrollToSection = (sectionId) => {
  const element = document.getElementById(sectionId)
  if (element) {
    const offset = 100 // ë„¤ë¹„ê²Œì´ì…˜ ë†’ì´ ê³ ë ¤
    const elementPosition = element.offsetTop - offset

    window.scrollTo({
      top: elementPosition,
      behavior: 'smooth'
    })
  }
}

onMounted(() => {
  window.addEventListener('scroll', onScroll, { passive: true })
  updateActiveSection()
})

onUnmounted(() => {
  window.removeEventListener('scroll', onScroll)
})
</script>

<style lang="scss" scoped>
.code-archive-page {
  min-height: 100vh;
  background: var(--color-bg-secondary);
  padding-top: 80px; // ë„¤ë¹„ê²Œì´ì…˜ ê³µê°„ í™•ë³´
}

// ê³ ì • ë„¤ë¹„ê²Œì´ì…˜
.sticky-nav {
  position: fixed;
  top: 60px; // í—¤ë” ì•„ë˜
  left: 0;
  right: 0;
  background: var(--color-bg-primary);
  border-bottom: 1px solid var(--color-border);
  z-index: 100;
  transition: transform 0.3s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);

  &.hidden {
    transform: translateY(-100%);
  }
}

.nav-content {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 2rem;
  display: flex;
  gap: 0.5rem;
  overflow-x: auto;

  // ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸°
  &::-webkit-scrollbar {
    display: none;
  }
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.nav-item {
  padding: 1rem 1.5rem;
  background: none;
  border: none;
  border-bottom: 2px solid transparent;
  color: var(--color-text-secondary);
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
  flex-shrink: 0;

  &:hover {
    color: var(--color-text-primary);
  }

  &.active {
    color: var(--color-accent);
    border-bottom-color: var(--color-accent);
  }
}

// í˜ì´ì§€ ì½˜í…ì¸ 
.page-content {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

.content-section {
  margin-bottom: 4rem;
  scroll-margin-top: 150px; // ê³ ì • ë„¤ë¹„ê²Œì´ì…˜ ê³ ë ¤
}

.main-title {
  font-size: 3rem;
  font-weight: 800;
  color: var(--color-text-primary);
  margin-bottom: 0.5rem;

  @media (max-width: 768px) {
    font-size: 2rem;
  }
}

.subtitle {
  font-size: 1.25rem;
  color: var(--color-text-secondary);
  margin-bottom: 2rem;
}

h2 {
  font-size: 2rem;
  font-weight: 700;
  color: var(--color-text-primary);
  margin-bottom: 1.5rem;
  padding-bottom: 0.75rem;
  border-bottom: 2px solid var(--color-border);
}

h3 {
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--color-text-primary);
  margin-bottom: 1rem;
}

// ì •ë³´ ì¹´ë“œ
.info-card {
  background: var(--color-bg-primary);
  border: 1px solid var(--color-border);
  border-radius: 12px;
  padding: 2rem;
  margin-bottom: 2rem;

  p {
    color: var(--color-text-secondary);
    line-height: 1.8;
    margin: 0;
  }
}

// ë§í¬ ê·¸ë¦¬ë“œ
.links-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1rem;
  margin-bottom: 2rem;
}

.link-card {
  background: var(--color-bg-primary);
  border: 2px solid var(--color-border);
  border-radius: 12px;
  padding: 1.5rem;
  text-decoration: none;
  transition: all 0.3s;
  text-align: center;

  &:hover {
    border-color: var(--color-accent);
    transform: translateY(-4px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
  }
}

.link-icon {
  font-size: 2.5rem;
  margin-bottom: 0.75rem;
}

.link-title {
  font-size: 1.125rem;
  font-weight: 600;
  color: var(--color-text-primary);
  margin-bottom: 0.5rem;
}

.link-url {
  font-size: 0.875rem;
  color: var(--color-accent);
  font-family: 'Courier New', monospace;
}

// ê¸°ìˆ  ê·¸ë¦¬ë“œ
.tech-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1.5rem;
}

.tech-category {
  background: var(--color-bg-primary);
  border: 1px solid var(--color-border);
  border-radius: 12px;
  padding: 1.5rem;

  h3 {
    margin-bottom: 1rem;
    color: var(--color-accent);
  }

  ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  li {
    padding: 0.5rem 0;
    color: var(--color-text-secondary);
    line-height: 1.6;

    strong {
      color: var(--color-text-primary);
    }
  }
}

// ê¸°ëŠ¥ ê·¸ë¦¬ë“œ
.features-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1.5rem;
}

.feature-card {
  background: var(--color-bg-primary);
  border: 1px solid var(--color-border);
  border-radius: 12px;
  padding: 1.5rem;
  transition: all 0.3s;

  &:hover {
    border-color: var(--color-accent);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
}

.feature-icon {
  font-size: 2rem;
  margin-bottom: 1rem;
}

// ì½”ë“œ ë¸”ë¡
.code-block {
  background: #1e1e1e;
  border-radius: 8px;
  padding: 1.5rem;
  margin: 1rem 0;
  overflow-x: auto;

  pre {
    margin: 0;

    code {
      font-family: 'Courier New', Consolas, monospace;
      font-size: 0.875rem;
      line-height: 1.6;
      color: #d4d4d4;
      white-space: pre;
    }
  }
}

.code-explanation {
  margin-bottom: 2.5rem;

  p {
    color: var(--color-text-secondary);
    margin-bottom: 1rem;
  }
}

.explanation-list {
  list-style: none;
  padding: 0;
  margin: 1rem 0;

  li {
    padding: 0.5rem 0;
    padding-left: 1.5rem;
    position: relative;
    color: var(--color-text-secondary);
    line-height: 1.6;

    &::before {
      content: 'â†’';
      position: absolute;
      left: 0;
      color: var(--color-accent);
      font-weight: bold;
    }

    code {
      background: var(--color-bg-tertiary);
      padding: 0.125rem 0.375rem;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 0.875rem;
      color: var(--color-accent);
    }
  }
}

// íƒ€ì„ë¼ì¸
.timeline {
  position: relative;
  padding-left: 3rem;

  &::before {
    content: '';
    position: absolute;
    left: 1rem;
    top: 0;
    bottom: 0;
    width: 2px;
    background: var(--color-border);
  }
}

.timeline-item {
  position: relative;
  margin-bottom: 2rem;

  &:last-child {
    margin-bottom: 0;
  }
}

.timeline-marker {
  position: absolute;
  left: -2.5rem;
  top: 0;
  width: 2rem;
  height: 2rem;
  background: var(--color-accent);
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  font-size: 0.875rem;
  box-shadow: 0 0 0 4px var(--color-bg-secondary);
}

.timeline-content {
  background: var(--color-bg-primary);
  border: 1px solid var(--color-border);
  border-radius: 12px;
  padding: 1.5rem;

  h3 {
    margin-top: 0;
  }

  ul {
    margin: 0;
    padding-left: 1.5rem;
  }

  li {
    color: var(--color-text-secondary);
    line-height: 1.8;
    margin-bottom: 0.5rem;
  }
}

// í–¥í›„ ê³„íš
.future-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
}

.future-card {
  background: var(--color-bg-primary);
  border: 1px solid var(--color-border);
  border-radius: 12px;
  padding: 1.5rem;
  text-align: center;
  transition: all 0.3s;

  &:hover {
    border-color: var(--color-accent);
    transform: translateY(-4px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
}

.future-icon {
  font-size: 2.5rem;
  margin-bottom: 1rem;
}

.future-card h3 {
  margin-bottom: 0.75rem;
}

.future-card p {
  color: var(--color-text-secondary);
  font-size: 0.9375rem;
  line-height: 1.6;
  margin: 0;
}

// ë°˜ì‘í˜•
@media (max-width: 768px) {
  .code-archive-page {
    padding-top: 60px;
  }

  .sticky-nav {
    top: 50px;
  }

  .nav-item {
    padding: 0.875rem 1rem;
    font-size: 0.875rem;
  }

  .page-content {
    padding: 1rem;
  }

  .timeline {
    padding-left: 2rem;

    &::before {
      left: 0.5rem;
    }
  }

  .timeline-marker {
    left: -1.75rem;
    width: 1.5rem;
    height: 1.5rem;
    font-size: 0.75rem;
  }
}
</style>
